# GitHub Copilot Instructions

## プロジェクト前提情報
- AWS CDK(TypeScript) を用いたインフラ構成管理リポジトリ。
- コードは `lib/` 配下のスタック定義と `lambda/` 配下の関数実装が中心。
- テストは `jest` を利用し、`npm run test` で実行可能。

## コーディング規約
- TypeScript の型推論を活かしつつ、`any` や曖昧な型は避ける。
- CDK の Construct は意図が分かる命名を行い、Props 型を活用して入力を整理する。
- インポートはパス順(`node_modules` → ローカル) でまとめ、未使用インポートを残さない。
- リソース識別子やタグは定数化し、環境ごとの差分が分かる構造にする。
- コメントは必要最小限に留め、複雑な意図を説明する場合のみ日本語で記述する。

## インフラ設計ポリシー
- Least Privilege を徹底し、IAM ポリシーは必要最小限のアクションとリソースに限定する。
- パラメータやシークレットは CDK Context や SSM Parameter Store 等に外出しし、ハードコードを避ける。
- スタック境界は責務ごとに分割し、循環依存を生まないよう注意する。
- デプロイ済みリソースへの破壊的変更がある場合は、代替案やマイグレーション手順をコメントやドキュメントで補足する。

## テストと検証
- 新規リソースや挙動追加時は Jest テストを更新し、`npm run test` での成功を確認する。
- CDK の Synth 結果に差分が出る変更は `npx cdk synth` でテンプレート確認を行う。
- 可能な限り `npx cdk diff` で既存との変更点を把握し、リスクを説明できるようにする。

## ドキュメントとレビュー
- Pull Request には目的・変更点・デプロイ手順・テスト結果を箇条書きでまとめる。
- README や設計資料への追記が必要な変更は同一 PR 内で更新する。
- **最低限日本語でレビュー可能な記述を行うこと。** PR 説明文やレビューコメントは日本語で書く。
- 変更範囲が広い場合は論理単位でコミットを分け、コミットメッセージも簡潔な日本語を推奨する。

## 生成 AI への補足プロンプト例
```
このリポジトリは AWS CDK(TypeScript) プロジェクトです。TypeScript の型安全性を保ちつつ、IAM ポリシーは最小権限で作成してください。PR ではテスト結果を日本語で報告し、日本語レビューが可能な説明を付けてください。
```
